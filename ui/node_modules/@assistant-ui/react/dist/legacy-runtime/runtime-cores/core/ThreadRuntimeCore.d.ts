import type { ReadonlyJSONValue } from "assistant-stream/utils";
import { ModelContext } from "../../../model-context/index.js";
import { AppendMessage, ThreadMessage } from "../../../types/index.js";
import { RunConfig } from "../../../types/AssistantTypes.js";
import type { Unsubscribe } from "../../../types/Unsubscribe.js";
import { SpeechSynthesisAdapter } from "../adapters/speech/SpeechAdapterTypes.js";
import { ChatModelRunOptions, ChatModelRunResult } from "../local/index.js";
import { ExportedMessageRepository } from "../utils/MessageRepository.js";
import { ThreadMessageLike } from "../external-store/index.js";
import { ComposerRuntimeCore, ThreadComposerRuntimeCore } from "./ComposerRuntimeCore.js";
export type RuntimeCapabilities = {
    readonly switchToBranch: boolean;
    readonly switchBranchDuringRun: boolean;
    readonly edit: boolean;
    readonly reload: boolean;
    readonly cancel: boolean;
    readonly unstable_copy: boolean;
    readonly speech: boolean;
    readonly dictation: boolean;
    readonly attachments: boolean;
    readonly feedback: boolean;
};
export type AddToolResultOptions = {
    messageId: string;
    toolName: string;
    toolCallId: string;
    result: ReadonlyJSONValue;
    isError: boolean;
    artifact?: ReadonlyJSONValue | undefined;
};
export type ResumeToolCallOptions = {
    toolCallId: string;
    payload: unknown;
};
export type SubmitFeedbackOptions = {
    messageId: string;
    type: "negative" | "positive";
};
export type ThreadSuggestion = {
    prompt: string;
};
export type SpeechState = {
    readonly messageId: string;
    readonly status: SpeechSynthesisAdapter.Status;
};
export type SubmittedFeedback = {
    readonly type: "negative" | "positive";
};
export type ThreadRuntimeEventType = "runStart" | "runEnd" | "initialize" | "modelContextUpdate";
export type StartRunConfig = {
    parentId: string | null;
    sourceId: string | null;
    runConfig: RunConfig;
};
export type ResumeRunConfig = StartRunConfig & {
    stream?: (options: ChatModelRunOptions) => AsyncGenerator<ChatModelRunResult, void, unknown>;
};
export type ThreadRuntimeCore = Readonly<{
    getMessageById: (messageId: string) => {
        parentId: string | null;
        message: ThreadMessage;
        index: number;
    } | undefined;
    getBranches: (messageId: string) => readonly string[];
    switchToBranch: (branchId: string) => void;
    append: (message: AppendMessage) => void;
    startRun: (config: StartRunConfig) => void;
    resumeRun: (config: ResumeRunConfig) => void;
    cancelRun: () => void;
    addToolResult: (options: AddToolResultOptions) => void;
    resumeToolCall: (options: ResumeToolCallOptions) => void;
    speak: (messageId: string) => void;
    stopSpeaking: () => void;
    submitFeedback: (feedback: SubmitFeedbackOptions) => void;
    getModelContext: () => ModelContext;
    composer: ThreadComposerRuntimeCore;
    getEditComposer: (messageId: string) => ComposerRuntimeCore | undefined;
    beginEdit: (messageId: string) => void;
    speech: SpeechState | undefined;
    capabilities: Readonly<RuntimeCapabilities>;
    isDisabled: boolean;
    isLoading: boolean;
    messages: readonly ThreadMessage[];
    state: ReadonlyJSONValue;
    suggestions: readonly ThreadSuggestion[];
    extras: unknown;
    subscribe: (callback: () => void) => Unsubscribe;
    import(repository: ExportedMessageRepository): void;
    export(): ExportedMessageRepository;
    /**
     * Export the thread state in the external store format.
     * For AI SDK runtimes, this returns the AI SDK message format.
     * For other runtimes, this may return different formats or throw an error.
     * @returns The thread state in the external format (typed as any)
     */
    exportExternalState(): any;
    /**
     * Import thread state from the external store format.
     * For AI SDK runtimes, this accepts AI SDK messages.
     * For other runtimes, this may accept different formats or throw an error.
     * @param state The thread state in the external format (typed as any)
     */
    importExternalState(state: any): void;
    reset(initialMessages?: readonly ThreadMessageLike[]): void;
    unstable_on(event: ThreadRuntimeEventType, callback: () => void): Unsubscribe;
    /**
     * @deprecated Use importExternalState instead. This method will be removed in 0.12.0.
     */
    unstable_loadExternalState: (state: any) => void;
}>;
//# sourceMappingURL=ThreadRuntimeCore.d.ts.map