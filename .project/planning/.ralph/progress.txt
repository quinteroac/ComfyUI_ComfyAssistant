## Codebase Patterns
- Keep user-context personality loading backward-compatible by resolving active persona first and falling back to legacy `user_context/SOUL.md`.
- Validate persona provider bindings against `providers.db` before injecting persona instructions into the system prompt.

## [2026-02-15 23:06:35 CST] - US-001
- Implemented persona folder convention under `user_context/personas/<slug>/SOUL.md` with required frontmatter fields (Name, Description, Provider) and free-text body support.
- Added backend loading for active persona via `preferences.active_persona`, with slug validation, SOUL frontmatter parsing, provider existence validation, and legacy SOUL fallback.
- Updated prompt assembly to include active persona metadata and applied documentation updates for persona layout/conventions.
- Files changed:
  - `user_context_store.py`
  - `user_context_loader.py`
  - `agent_prompts.py`
  - `.gitignore`
  - `user_context/README.md`
  - `user_context/personas/README.md`
  - `doc/configuration.md`
  - `doc/dev_docs/context-and-environment.md`
  - `.agents/project-context.md`
  - `.agents/skills/system-and-user-context/SKILL.md`
  - `.project/planning/.ralph/prd.json`
  - `.project/planning/.ralph/progress.txt`
- **Learnings for future iterations:**
  - Keep persona metadata parsing strict (required frontmatter + body) so later slash commands can rely on consistent files.
  - `.agents/` docs may require direct shell writes when patch tooling blocks hidden-path edits.
  - Repository-wide frontend lint currently has unrelated baseline issues; story-scoped Python checks passed.
---
